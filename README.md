# 智能公文助手项目

这个项目是一个集成了文档处理和智能问答功能的系统，支持公文纠错、内容优化、格式保留处理以及智能问答等功能。

## 项目结构

项目包含两个主要部分：
- 后端服务 (`we_chatbot` 目录)：基于FastAPI的后端API服务
- 前端界面 (`VUE/vue3-init-demo` 目录)：基于Vue3的用户界面

## 核心功能

### 文档处理功能
- **公文纠错**：自动识别和修正公文中的错误用词、标点符号和语法问题
- **内容润色**：优化文档表达，提高公文语言的规范性和专业度
- **格式保留处理**：处理文档时保留原始格式，包括字体、段落样式、页面设置等
- **MCP协议支持**：通过MCP协议提供高级文档处理服务，支持纠错、润色和总结等多种处理模式

### 用户交互功能
- **文件上传与管理**：支持.docx格式文件的上传、预览和管理
- **文档历史记录**：保存处理过的文档历史，方便用户查看和比较
- **聊天界面**：通过自然语言交互方式处理文档
- **聊天历史管理**：保存用户与系统的对话历史
- **实时预览**：处理后的文档可在线预览，无需下载即可查看效果
- **文档下载**：支持下载处理后的文档，保留原始格式

## 系统要求

- Python 3.8+
- Node.js 16+
- npm 或 yarn
- 支持.docx格式文件处理的相关库

## 安装与设置

### 后端设置

1. 进入后端项目目录：
   ```bash
   cd we_chatbot
   ```

2. 创建并激活Python虚拟环境：
   ```bash
   python -m venv venv
   # Windows:
   venv\Scripts\activate
   # Linux/Mac:
   source venv/bin/activate
   ```

3. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```

4. 配置环境变量：
   创建或编辑`.env`文件，添加以下内容（根据实际情况修改）：
   ```
   DEEPSEEK_API_KEY=your_api_key_here
   DEEPSEEK_API_BASE=your_api_base_url_here
   ```

### 前端设置

1. 进入前端项目目录：
   ```bash
   cd VUE/vue3-init-demo
   ```

2. 安装依赖：
   ```bash
   npm install
   # 或使用yarn
   yarn install
   ```

## 运行项目

### 启动后端服务

1. 确保你在后端项目目录并且虚拟环境已激活：
   ```bash
   cd we_chatbot
   # 如果虚拟环境未激活，请激活它
   ```

2. 启动FastAPI服务：
   ```bash
   python -m api.main --host 0.0.0.0 --port 8003
   ```
   服务将在 `http://localhost:8003` 上运行。

### 启动前端服务

1. 确保你在前端项目目录中：
   ```bash
   cd VUE/vue3-init-demo
   ```

2. 启动开发服务器：
   ```bash
   npm run dev
   ```
   
3. 浏览器会自动打开或你可以访问：
   ```
   http://localhost:3002
   ```

## 使用指南

### 文档处理

1. **上传文档**：点击左侧面板的"上传新文件"按钮上传Word文档
2. **文档纠错**：
   - 在聊天框中输入"纠错"进行基本纠错处理
   - 系统将自动调用MCP纠错工具处理文档
3. **文档润色**：
   - 在聊天框中输入"润色"进行语言表达优化
   - 系统将调用MCP润色工具处理文档
4. **文档总结**：
   - 在聊天框中输入"总结"生成文档摘要
   - 系统将调用MCP总结工具处理文档
5. **预览文档**：处理完成后，系统自动显示预览，可查看修改效果
6. **下载文档**：点击界面上的下载按钮，获取处理后的文档

### 文档管理

1. **文档列表**：左侧面板显示已上传的文档列表
2. **文档切换**：点击列表中的任意文档进行切换，系统会自动重置处理状态
3. **文档历史**：系统保存处理历史，方便追踪文档的变更

### 聊天功能

1. **创建新聊天**：点击"新对话"按钮创建全新对话
2. **聊天历史**：系统保存聊天历史，可随时查看过去的对话
3. **指定处理**：通过聊天指令指定不同的处理方式

## 技术特性

### 三步式文档格式保留处理

系统采用三步式方法处理文档，最大程度保留原始格式：
1. 完整保存原始文档的所有格式属性
2. 用处理后的文本内容创建新文档
3. 将保存的格式应用到新文档

### MCP协议集成

系统集成了MCP协议，提供高级文档处理服务：
- **纠错算法**：自动检测并修正文档中的语法、标点和用词错误
- **润色工具**：优化文档语言表达，提高公文质量
- **总结工具**：提取文档关键信息，生成摘要

### 实时流式对话

- 使用流式对话模式，提供实时响应体验
- 支持长文档处理和复杂指令理解
- 动态展示处理进度和结果

## 常见问题

1. **服务连接问题**：如果前端无法连接后端，请检查后端服务是否正常运行，以及`.env`文件中的配置是否正确。

2. **文件上传失败**：确保上传的是.docx格式文件，且文件大小不超过系统限制。

3. **格式保留不完全**：复杂格式（如表格、图片布局等）可能无法完全保留，这是由于技术限制导致的。

4. **处理速度慢**：大型文档处理可能需要较长时间，请耐心等待。


## 贡献与支持

如有问题或建议，请通过GitHub Issues提交反馈。 